<!-- MBTIäººæ ¼æµ‹è¯•é¡µé¢ -->
<view class="container">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header">
    <text class="title">MBTIäººæ ¼ç³»ç»Ÿ</text>
    <text class="subtitle">æ¢ç´¢ä½ çš„äººæ ¼ç‰¹è´¨ä¸æ½œèƒ½</text>
  </view>
  
  <!-- æ ‡ç­¾é¡µå¯¼èˆª - ä¼˜åŒ–ç‰ˆ -->
  <view class="tab-nav">
    <view class="tab-wrapper">
      <view class="tab-item {{activeTab == 0 ? 'active' : ''}}" bindtap="switchTab" data-index="0">
        <view class="tab-text">æ€§æ ¼æµ‹è¯•</view>
      </view>
      <view class="tab-item {{activeTab == 1 ? 'active' : ''}}" bindtap="switchTab" data-index="1">
        <view class="tab-text">äººæ ¼æ¨¡å‹</view>
      </view>
      <view class="slider" style="transform: translateX({{activeTab * 100}}%)"></view>
    </view>
  </view>
  
  <!-- æµ‹è¯•å†…å®¹æ ‡ç­¾é¡µ -->
  <view class="tab-content" hidden="{{activeTab != 0}}">
    <!-- æµ‹è¯•æœªå®Œæˆæ—¶æ˜¾ç¤ºé¢˜ç›® -->
    <block wx:if="{{!testCompleted}}">
      <view class="progress-container">
        <view class="progress-text">é—®é¢˜ {{currentQuestion + 1}}/{{questions.length}}</view>
        <view class="progress-bar">
          <view class="progress-value" style="width: {{(currentQuestion + 1) / questions.length * 100}}%;"></view>
        </view>
      </view>
      
      <view class="question-card">
        <view class="question-number">ç¬¬{{currentQuestion + 1}}é¢˜</view>
        <view class="question-text">{{questions[currentQuestion].text || questions[currentQuestion].question}}</view>
        <view class="options-container">
          <view class="option {{selectedOption === 'A' ? 'active' : ''}}" bindtap="selectOption" data-value="A">
            <view class="radio {{selectedOption === 'A' ? 'checked' : ''}}"></view>
            <text>{{questions[currentQuestion].options.A || questions[currentQuestion].optionA}}</text>
          </view>
          <view class="option {{selectedOption === 'B' ? 'active' : ''}}" bindtap="selectOption" data-value="B">
            <view class="radio {{selectedOption === 'B' ? 'checked' : ''}}"></view>
            <text>{{questions[currentQuestion].options.B || questions[currentQuestion].optionB}}</text>
          </view>
        </view>
      </view>
      
      <view class="navigation-buttons">
        <button class="prev-btn" bindtap="prevQuestion" disabled="{{currentQuestion === 0}}">ä¸Šä¸€é¢˜</button>
        <button class="next-btn" bindtap="nextQuestion" disabled="{{!selectedOption}}">{{currentQuestion === questions.length - 1 ? 'å®Œæˆæµ‹è¯•' : 'ä¸‹ä¸€é¢˜'}}</button>
      </view>
      
      <view class="test-tips">
        <text class="tip-text">è¯·æ ¹æ®æ‚¨çš„ç¬¬ä¸€ååº”é€‰æ‹©æœ€ç¬¦åˆçš„é€‰é¡¹</text>
        <text class="tip-text">ç­”æ¡ˆæ²¡æœ‰å¯¹é”™ä¹‹åˆ†ï¼Œé€‰æ‹©æœ€é€‚åˆæ‚¨çš„é€‰é¡¹å³å¯</text>
      </view>
    </block>
    
    <!-- æµ‹è¯•å®Œæˆåæ˜¾ç¤ºç»“æœ -->
    <block wx:else>
      <view class="result-section">
        <view class="result-header">
          <view class="result-title">ä½ çš„MBTIç±»å‹</view>
          <text class="result-time">{{result.timeStr || 'åˆšåˆš'}}</text>
        </view>
        
        <view class="personality-card">
          <view class="flex justify-between items-center">
            <view class="personality-type">{{result.type}}</view>
            <view class="personality-percentage">å æ¯” {{result.percentage}}</view>
          </view>
          <view class="personality-name">{{result.name}}</view>
          <view class="personality-alias">{{result.alias || 'æ€æƒ³å®¶'}}</view>
        </view>
        
        <view class="personality-description-box">
          <view class="personality-description">{{result.description}}</view>
        </view>
        
        <!-- å®Œæ•´æè¿° -->
        <view class="section-title">å®Œæ•´æ€§æ ¼æè¿°</view>
        <view class="full-description-box">
          <view class="full-description">{{result.fullDescription || result.description}}</view>
        </view>
        
        <!-- æ€§æ ¼ä¼˜åŠ¿å’ŒåŠ£åŠ¿ -->
        <view class="strengths-weaknesses">
          <view class="sw-container">
            <view class="section-title">æ€§æ ¼ä¼˜åŠ¿</view>
            <view class="sw-list">
              <view class="sw-item" wx:for="{{result.strengths}}" wx:key="index">
                <view class="sw-bullet">âœ“</view>
                <view class="sw-text">{{item}}</view>
              </view>
            </view>
          </view>
          
          <view class="sw-container">
            <view class="section-title">æ€§æ ¼åŠ£åŠ¿</view>
            <view class="sw-list">
              <view class="sw-item" wx:for="{{result.weaknesses}}" wx:key="index">
                <view class="sw-bullet">!</view>
                <view class="sw-text">{{item}}</view>
              </view>
            </view>
          </view>
        </view>
        
        <view class="section-title">æ€§æ ¼åå¥½åˆ†æ</view>
        <view class="preference-container">
          <block wx:if="{{result.scores}}">
            <view class="preference-item">
              <view class="preference-header">
                <view class="preference-name">å†…å‘ (I)</view>
                <view class="preference-vs">vs</view>
                <view class="preference-name">å¤–å‘ (E)</view>
              </view>
              <view class="preference-bar">
                <view class="preference-value" style="width: {{result.scores.I || 0}}%;"></view>
              </view>
              <view class="preference-percentage">{{result.scores.I || 0}}%</view>
            </view>
            
            <view class="preference-item">
              <view class="preference-header">
                <view class="preference-name">ç›´è§‰ (N)</view>
                <view class="preference-vs">vs</view>
                <view class="preference-name">å®æ„Ÿ (S)</view>
              </view>
              <view class="preference-bar">
                <view class="preference-value" style="width: {{result.scores.N || 0}}%;"></view>
              </view>
              <view class="preference-percentage">{{result.scores.N || 0}}%</view>
            </view>
            
            <view class="preference-item">
              <view class="preference-header">
                <view class="preference-name">æƒ…æ„Ÿ (F)</view>
                <view class="preference-vs">vs</view>
                <view class="preference-name">æ€è€ƒ (T)</view>
              </view>
              <view class="preference-bar">
                <view class="preference-value" style="width: {{result.scores.F || 0}}%;"></view>
              </view>
              <view class="preference-percentage">{{result.scores.F || 0}}%</view>
            </view>
            
            <view class="preference-item">
              <view class="preference-header">
                <view class="preference-name">åˆ¤æ–­ (J)</view>
                <view class="preference-vs">vs</view>
                <view class="preference-name">æ„ŸçŸ¥ (P)</view>
              </view>
              <view class="preference-bar">
                <view class="preference-value" style="width: {{result.scores.P || 0}}%;"></view>
              </view>
              <view class="preference-percentage">{{result.scores.P || 0}}%</view>
            </view>
          </block>
          <block wx:else>
            <view class="no-data-message">æš‚æ— åå¥½åˆ†ææ•°æ®</view>
          </block>
        </view>
        
        <view class="section-title">è®¤çŸ¥åŠŸèƒ½æ ˆ</view>
        <view class="cognitive-functions">
          <block wx:if="{{result.functions && result.functions.length >= 4}}">
            <view class="function-item primary">
              <view class="function-header">
                <text class="function-name">{{result.functions[0].code}} - {{result.functions[0].name}}</text>
                <text class="function-role">ä¸»å¯¼åŠŸèƒ½</text>
              </view>
              <text class="function-description">{{result.functions[0].description}}</text>
            </view>
            
            <view class="function-item secondary">
              <view class="function-header">
                <text class="function-name">{{result.functions[1].code}} - {{result.functions[1].name}}</text>
                <text class="function-role">è¾…åŠ©åŠŸèƒ½</text>
              </view>
              <text class="function-description">{{result.functions[1].description}}</text>
            </view>
            
            <view class="function-item tertiary">
              <view class="function-header">
                <text class="function-name">{{result.functions[2].code}} - {{result.functions[2].name}}</text>
                <text class="function-role">ç¬¬ä¸‰åŠŸèƒ½</text>
              </view>
              <text class="function-description">{{result.functions[2].description}}</text>
            </view>
            
            <view class="function-item inferior">
              <view class="function-header">
                <text class="function-name">{{result.functions[3].code}} - {{result.functions[3].name}}</text>
                <text class="function-role">åŠ£åŠ¿åŠŸèƒ½</text>
              </view>
              <text class="function-description">{{result.functions[3].description}}</text>
            </view>
          </block>
          <block wx:else>
            <view class="no-data-message">æš‚æ— è®¤çŸ¥åŠŸèƒ½æ•°æ®</view>
          </block>
        </view>
        
        <!-- èŒä¸šå»ºè®® -->
        <view class="section-title">é€‚åˆçš„èŒä¸š</view>
        <view class="careers-container">
          <view class="careers-list">
            <view class="career-item" wx:for="{{result.careers}}" wx:key="index">
              <view class="career-icon">ğŸ’¼</view>
              <view class="career-name">{{item}}</view>
            </view>
          </view>
        </view>
        
        <!-- äººé™…å…³ç³»ç‰¹ç‚¹ -->
        <view class="section-title">äººé™…å…³ç³»</view>
        <view class="relationship-box">
          <view class="relationship-section">
            <view class="relationship-title">ä¼˜åŠ¿</view>
            <view class="relationship-content">{{result.relationshipStrengths}}</view>
          </view>
          <view class="relationship-section">
            <view class="relationship-title">æŒ‘æˆ˜</view>
            <view class="relationship-content">{{result.relationshipChallenges}}</view>
          </view>
        </view>
        
        <!-- æ²Ÿé€šä¸å·¥ä½œé£æ ¼ -->
        <view class="section-title">æ²Ÿé€šä¸å·¥ä½œ</view>
        <view class="style-container">
          <view class="style-item">
            <view class="style-title">æ²Ÿé€šé£æ ¼</view>
            <view class="style-content">{{result.communicationStyle}}</view>
          </view>
          <view class="style-item">
            <view class="style-title">å·¥ä½œé£æ ¼</view>
            <view class="style-content">{{result.workStyle}}</view>
          </view>
        </view>
        
        <!-- æˆé•¿ä¸å‘å±• -->
        <view class="section-title">æˆé•¿ä¸å‘å±•</view>
        <view class="growth-container">
          <view class="growth-item">
            <view class="growth-title">å‹åŠ›ä¸‹ååº”</view>
            <view class="growth-content">{{result.stressReactions}}</view>
          </view>
          <view class="growth-item">
            <view class="growth-title">æˆé•¿æ–¹å‘</view>
            <view class="growth-content">{{result.growthAreas}}</view>
          </view>
        </view>
        
        <!-- è‘—åäººç‰© -->
        <view class="section-title">ç›¸åŒç±»å‹çš„åäºº</view>
        <view class="famous-people">
          <view class="people-item" wx:for="{{result.famousPeople}}" wx:key="index">
            <view class="people-icon">ğŸ‘¤</view>
            <view class="people-name">{{item}}</view>
          </view>
        </view>
        
        <button class="restart-btn" bindtap="restartTest">é‡æ–°æµ‹è¯•</button>
      </view>
    </block>
  </view>
  
  <!-- äººæ ¼æ¨¡å‹æ ‡ç­¾é¡µ -->
  <view class="tab-content" hidden="{{activeTab != 1}}">
    <block wx:if="{{result && result.type}}">
      <view class="model-section">
        <view class="section-title">äººæ ¼æ¨¡å‹</view>
        <!-- äººæ ¼æ¨¡å‹
        <view class="model-card">
          <view class="model-header">
            <view class="model-icon">â˜¯</view>
            <view class="model-title">
              <text class="model-name">ä¸ªäººæ•°æ®ä¸MBTIè½¬åŒ–</text>
              <text class="model-subtitle">å°†ä¸ªäººæ•°æ®å¯¹åº”MBTIåŠŸèƒ½è½´</text>
            </view>
          </view>
          
          <view class="model-content">
            <view class="connection-item">
              <text class="connection-left">æ­£å®˜</text>
              <view class="connection-line"></view>
              <text class="connection-right">Te</text>
            </view>
            <view class="connection-item">
              <text class="connection-left">ä¼¤å®˜</text>
              <view class="connection-line"></view>
              <text class="connection-right">Ne</text>
            </view>
            <view class="connection-item">
              <text class="connection-left">é£Ÿç¥</text>
              <view class="connection-line"></view>
              <text class="connection-right">Fe</text>
            </view>
            <view class="connection-item">
              <text class="connection-left">åå°</text>
              <view class="connection-line"></view>
              <text class="connection-right">Ni</text>
            </view>
          </view>
        </view>
         -->
        <view class="personality-grid">
          <view class="personality-grid-item">
            <view class="grid-title">åŸç”Ÿäººæ ¼</view>
            <view class="grid-type">{{modelData.nativeType}}</view>
            <view class="grid-name">{{modelData.nativeName}}</view>
            <view class="grid-description">{{modelData.nativeDescription}}</view>
          </view>
          
          <view class="personality-grid-item">
            <view class="grid-title">ç¤¾ä¼šé¢å…·</view>
            <view class="grid-type">{{modelData.socialType}}</view>
            <view class="grid-name">{{modelData.socialName}}</view>
            <view class="grid-description">{{modelData.socialDescription}}</view>
          </view>
        </view>
        
        <view class="radar-section">
          <view class="section-title">äººæ ¼èƒ½é‡é›·è¾¾</view>
          <view class="radar-chart">
            <view class="radar-value"></view>
          </view>
          <view class="radar-labels">
            <text class="radar-label">æ€è€ƒåŠ›</text>
            <text class="radar-label">åˆ›é€ åŠ›</text>
            <text class="radar-label">æ‰§è¡ŒåŠ›</text>
            <text class="radar-label">æ„ŸçŸ¥åŠ›</text>
          </view>
        </view>
      </view>
      
      <view class="career-section">
        <view class="section-title">èŒä¸šç½—ç›˜</view>
        
        <view class="industry-match">
          <view class="industry-header">
            <view class="icon icon-blue">ğŸ’¼</view>
            <view class="industry-title">è¡Œä¸šåŒ¹é…</view>
          </view>
          
          <view class="industry-description">æ ¹æ®ä½ çš„äº”è¡Œå–œç”¨ç¥å’ŒMBTIç‰¹è´¨ï¼Œä»¥ä¸‹è¡Œä¸šæœ€é€‚åˆä½ ï¼š</view>
          
          <view class="industry-grid">
            <view class="industry-item" wx:for="{{modelData.industries}}" wx:key="index">
              <view class="icon {{item.icon}} icon-blue"></view>
              <text class="industry-item-name">{{item.name}}</text>
            </view>
          </view>
        </view>
        
        <view class="direction-match">
          <view class="direction-header">
            <view class="icon icon-blue">ğŸ§­</view>
            <view class="direction-title">å·¥ä½œæ–¹ä½</view>
          </view>
          
          <view class="direction-grid">
            <view class="direction-item {{item.type}}" wx:for="{{modelData.directions}}" wx:key="index">
              <text class="direction-item-name">{{item.name}} ({{item.type === 'good' ? 'å‰' : 'å¿Œ'}})</text>
            </view>
          </view>
          
          <view class="direction-tip">
            <view class="tip-icon">â„¹ï¸</view>
            <text class="tip-text">{{modelData.directionTip}}</text>
          </view>
        </view>
      </view>
    </block>
    <block wx:else>
      <view class="no-result-prompt">
        <view class="prompt-icon">ğŸ§­</view>
        <view class="prompt-title">è¯·å…ˆå®ŒæˆMBTIæµ‹è¯•</view>
        <view class="prompt-description">å®Œæˆæµ‹è¯•åï¼Œå°†æ ¹æ®æ‚¨çš„äººæ ¼ç±»å‹ä¸ºæ‚¨æä¾›é‡èº«å®šåˆ¶çš„äººæ ¼æ¨¡å‹å’ŒèŒä¸šå»ºè®®</view>
        <button class="switch-to-test-btn" bindtap="switchToTestTab">å»æµ‹è¯•</button>
      </view>
    </block>
  </view>
</view> 